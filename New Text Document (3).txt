#!/bin/sh
# delete all files bigger than 50MB from git history
git rev-list --objects --all |
  git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' |
  awk '$1 == "blob" && $3 >= 52428800 { print $2 }' |
  while read hash; do
    git filter-branch --force --index-filter \
      "git rm --cached --ignore-unmatch $(git rev-list --objects --all | grep $hash | awk '{print $2}')" \
      --tag-name-filter cat -- --all
  done
